{"docker":[{"name":"FROM","lineno":1,"args":"php:7.3-apache","raw":"FROM php:7.3-apache"},{"name":"RUN","lineno":7,"args":"set -eux; \tapt-get update; \tapt-get install -y --no-install-recommends # Ghostscript is required for rendering PDF previews","raw":"RUN set -eux; \tapt-get update; \tapt-get install -y --no-install-recommends # Ghostscript is required for rendering PDF previews"},{"name":"GHOSTSCRIPT","lineno":10,"args":"; \trm -rf /var/lib/apt/lists/*","raw":"ghostscript \t; \trm -rf /var/lib/apt/lists/*"},{"name":"RUN","lineno":38,"args":"set -ex; \t\tsavedAptMark=\"$(apt-mark showmanual)\"; \t\tapt-get update; \tapt-get install -y --no-install-recommends \t\tlibfreetype6-dev \t\tlibjpeg-dev \t\tlibmagickwand-dev \t\tlibpng-dev \t\tlibzip-dev \t; \t\tdocker-php-ext-configure gd --with-freetype-dir=/usr --with-jpeg-dir=/usr --with-png-dir=/usr; \tdocker-php-ext-install -j \"$(nproc)\" \t\tbcmath \t\texif \t\tgd \t\tmysqli \t\topcache \t\tzip \t; \tpecl install imagick-3.4.4; \tdocker-php-ext-enable imagick; \t# reset apt-mark's \"manual\" list so that \"purge --auto-remove\" will remove all build dependencies","raw":"RUN set -ex; \t\tsavedAptMark=\"$(apt-mark showmanual)\"; \t\tapt-get update; \tapt-get install -y --no-install-recommends \t\tlibfreetype6-dev \t\tlibjpeg-dev \t\tlibmagickwand-dev \t\tlibpng-dev \t\tlibzip-dev \t; \t\tdocker-php-ext-configure gd --with-freetype-dir=/usr --with-jpeg-dir=/usr --with-png-dir=/usr; \tdocker-php-ext-install -j \"$(nproc)\" \t\tbcmath \t\texif \t\tgd \t\tmysqli \t\topcache \t\tzip \t; \tpecl install imagick-3.4.4; \tdocker-php-ext-enable imagick; \t# reset apt-mark's \"manual\" list so that \"purge --auto-remove\" will remove all build dependencies"},{"name":"APT-MARK","lineno":50,"args":"auto '.*' > /dev/null; \tapt-mark manual $savedAptMark; \tldd \"$(php -r 'echo ini_get(\"extension_dir\");')\"/*.so \t\t| awk '/=>/ { print $3 }' \t\t| sort -u \t\t| xargs -r dpkg-query -S \t\t| cut -d: -f1 \t\t| sort -u \t\t| xargs -rt apt-mark manual; \t\tapt-get purge -y --auto-remove -o APT::AutoRemove::RecommendsImportant=false; \trm -rf /var/lib/apt/lists/*","raw":"apt-mark auto '.*' > /dev/null; \tapt-mark manual $savedAptMark; \tldd \"$(php -r 'echo ini_get(\"extension_dir\");')\"/*.so \t\t| awk '/=>/ { print $3 }' \t\t| sort -u \t\t| xargs -r dpkg-query -S \t\t| cut -d: -f1 \t\t| sort -u \t\t| xargs -rt apt-mark manual; \t\tapt-get purge -y --auto-remove -o APT::AutoRemove::RecommendsImportant=false; \trm -rf /var/lib/apt/lists/*"},{"name":"RUN","lineno":60,"args":"{ \t\techo 'opcache.memory_consumption=128'; \t\techo 'opcache.interned_strings_buffer=8'; \t\techo 'opcache.max_accelerated_files=4000'; \t\techo 'opcache.revalidate_freq=2'; \t\techo 'opcache.fast_shutdown=1'; \t} > /usr/local/etc/php/conf.d/opcache-recommended.ini","raw":"RUN { \t\techo 'opcache.memory_consumption=128'; \t\techo 'opcache.interned_strings_buffer=8'; \t\techo 'opcache.max_accelerated_files=4000'; \t\techo 'opcache.revalidate_freq=2'; \t\techo 'opcache.fast_shutdown=1'; \t} > /usr/local/etc/php/conf.d/opcache-recommended.ini"},{"name":"RUN","lineno":63,"args":"{ # https://www.php.net/manual/en/errorfunc.constants.php","raw":"RUN { # https://www.php.net/manual/en/errorfunc.constants.php"},{"name":"ECHO","lineno":74,"args":"'error_reporting = E_ERROR | E_WARNING | E_PARSE | E_CORE_ERROR | E_CORE_WARNING | E_COMPILE_ERROR | E_COMPILE_WARNING | E_RECOVERABLE_ERROR'; \t\techo 'display_errors = Off'; \t\techo 'display_startup_errors = Off'; \t\techo 'log_errors = On'; \t\techo 'error_log = /dev/stderr'; \t\techo 'log_errors_max_len = 1024'; \t\techo 'ignore_repeated_errors = On'; \t\techo 'ignore_repeated_source = Off'; \t\techo 'html_errors = Off'; \t} > /usr/local/etc/php/conf.d/error-logging.ini","raw":"echo 'error_reporting = E_ERROR | E_WARNING | E_PARSE | E_CORE_ERROR | E_CORE_WARNING | E_COMPILE_ERROR | E_COMPILE_WARNING | E_RECOVERABLE_ERROR'; \t\techo 'display_errors = Off'; \t\techo 'display_startup_errors = Off'; \t\techo 'log_errors = On'; \t\techo 'error_log = /dev/stderr'; \t\techo 'log_errors_max_len = 1024'; \t\techo 'ignore_repeated_errors = On'; \t\techo 'ignore_repeated_source = Off'; \t\techo 'html_errors = Off'; \t} > /usr/local/etc/php/conf.d/error-logging.ini"},{"name":"RUN","lineno":79,"args":"set -eux; \ta2enmod rewrite expires; \t# https://httpd.apache.org/docs/2.4/mod/mod_remoteip.html","raw":"RUN set -eux; \ta2enmod rewrite expires; \t# https://httpd.apache.org/docs/2.4/mod/mod_remoteip.html"},{"name":"A2ENMOD","lineno":83,"args":"remoteip; \t{ \t\techo 'RemoteIPHeader X-Forwarded-For'; # these IP ranges are reserved for \"private\" use and should thus *usually* be safe inside Docker","raw":"a2enmod remoteip; \t{ \t\techo 'RemoteIPHeader X-Forwarded-For'; # these IP ranges are reserved for \"private\" use and should thus *usually* be safe inside Docker"},{"name":"ECHO","lineno":91,"args":"'RemoteIPTrustedProxy 10.0.0.0/8'; \t\techo 'RemoteIPTrustedProxy 172.16.0.0/12'; \t\techo 'RemoteIPTrustedProxy 192.168.0.0/16'; \t\techo 'RemoteIPTrustedProxy 169.254.0.0/16'; \t\techo 'RemoteIPTrustedProxy 127.0.0.0/8'; \t} > /etc/apache2/conf-available/remoteip.conf; \ta2enconf remoteip; # https://github.com/docker-library/wordpress/issues/383#issuecomment-507886512","raw":"echo 'RemoteIPTrustedProxy 10.0.0.0/8'; \t\techo 'RemoteIPTrustedProxy 172.16.0.0/12'; \t\techo 'RemoteIPTrustedProxy 192.168.0.0/16'; \t\techo 'RemoteIPTrustedProxy 169.254.0.0/16'; \t\techo 'RemoteIPTrustedProxy 127.0.0.0/8'; \t} > /etc/apache2/conf-available/remoteip.conf; \ta2enconf remoteip; # https://github.com/docker-library/wordpress/issues/383#issuecomment-507886512"},{"name":"FIND","lineno":93,"args":"/etc/apache2 -type f -name '*.conf' -exec sed -ri 's/([[:space:]]*LogFormat[[:space:]]+\"[^\"]*)%h([^\"]*\")/\\1%a\\2/g' '{}' +","raw":"find /etc/apache2 -type f -name '*.conf' -exec sed -ri 's/([[:space:]]*LogFormat[[:space:]]+\"[^\"]*)%h([^\"]*\")/\\1%a\\2/g' '{}' +"},{"name":"VOLUME","lineno":95,"args":["/var/www/html"],"raw":"VOLUME /var/www/html"},{"name":"ENV","lineno":97,"args":{"WORDPRESS_VERSION":"5.3.2"},"raw":"ENV WORDPRESS_VERSION 5.3.2"},{"name":"ENV","lineno":98,"args":{"WORDPRESS_SHA1":"fded476f112dbab14e3b5acddd2bcfa550e7b01b"},"raw":"ENV WORDPRESS_SHA1 fded476f112dbab14e3b5acddd2bcfa550e7b01b"},{"name":"RUN","lineno":103,"args":"set -ex; \tcurl -o wordpress.tar.gz -fSL \"https://wordpress.org/wordpress-${WORDPRESS_VERSION}.tar.gz\"; \techo \"$WORDPRESS_SHA1 *wordpress.tar.gz\" | sha1sum -c -; # upstream tarballs include ./wordpress/ so this gives us /usr/src/wordpress","raw":"RUN set -ex; \tcurl -o wordpress.tar.gz -fSL \"https://wordpress.org/wordpress-${WORDPRESS_VERSION}.tar.gz\"; \techo \"$WORDPRESS_SHA1 *wordpress.tar.gz\" | sha1sum -c -; # upstream tarballs include ./wordpress/ so this gives us /usr/src/wordpress"},{"name":"TAR","lineno":106,"args":"-xzf wordpress.tar.gz -C /usr/src/; \trm wordpress.tar.gz; \tchown -R www-data:www-data /usr/src/wordpress","raw":"tar -xzf wordpress.tar.gz -C /usr/src/; \trm wordpress.tar.gz; \tchown -R www-data:www-data /usr/src/wordpress"},{"name":"COPY","lineno":108,"args":["docker-entrypoint.sh","/usr/local/bin/"],"raw":"COPY docker-entrypoint.sh /usr/local/bin/"},{"name":"ENTRYPOINT","lineno":110,"args":["docker-entrypoint.sh"],"raw":"ENTRYPOINT [\"docker-entrypoint.sh\"]"},{"name":"CMD","lineno":111,"args":["apache2-foreground"],"raw":"CMD [\"apache2-foreground\"]"}]}